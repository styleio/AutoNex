# AutoNex

AutoNexは、Blocklyベースのビジュアルプログラミング環境でブラウザ操作を自動化するツールです。プログラミング知識がなくても、ブロックを組み合わせるだけで複雑なマウス・キーボード操作を自動化できます。

## 特徴

- **ビジュアルプログラミング**: Blocklyを使用した直感的なドラッグ&ドロップインターface
- **豊富なマウス操作**: 絶対座標移動、相対座標移動、各種クリック、スクロールなど
- **キーボード操作**: キー入力、テキスト入力
- **プログラム管理**: 作成したプログラムの保存・読み込み・管理
- **フェイルセーフ機能**: プログラムごとに安全機能のオン/オフ設定が可能
- **リアルタイム実行**: 作成したプログラムの即座実行と停止

## セットアップ

### 必要な環境
- Python 3.7以上
- pip（Python パッケージマネージャー）
- Webブラウザ（Chrome、Firefox、Safari、Edge等）

### インストール

1. **リポジトリをクローン**
   ```bash
   git clone <repository-url>
   cd WebMaestro
   ```

2. **依存関係をインストール**
   ```bash
   pip install -r requirements.txt
   ```

3. **アプリケーションを起動**
   ```bash
   python app.py
   ```

4. **ブラウザでアクセス**
   
   ブラウザで `http://localhost:5000` にアクセス

## 使い方

### 基本操作

1. **プログラム作成**
   - 左側のツールボックスからブロックをドラッグ
   - ワークスペース上でブロックを接続
   - ブロックのパラメータ（座標、秒数など）を設定

2. **プログラム保存**
   - プログラム名を入力
   - 「保存」ボタンをクリック
   - フェイルセーフ設定も一緒に保存されます

3. **プログラム読み込み**
   - ドロップダウンから保存済みプログラムを選択
   - 「読み込み」ボタンをクリック

4. **プログラム実行**
   - 「実行」ボタンをクリック
   - 実行中は「停止」ボタンで中断可能
   - 実行ログは右側パネルに表示

### ブロックの種類

#### マウス操作（緑色）

**座標移動**
- **マウスを絶対座標に移動**: 画面上の指定した座標(X, Y)にマウスを移動
- **マウスを相対座標に移動**: 現在位置から指定した距離だけマウスを移動

**クリック操作**
- **シングルクリック**: 左ボタン/右ボタンでのシングルクリック
- **ダブルクリック**: 左ボタン/右ボタンでのダブルクリック
- **トリプルクリック**: 左ボタン/右ボタンでのトリプルクリック
- **長押しクリック**: 指定した秒数だけボタンを押し続ける
- **リリース**: マウスボタンを離す
- **中クリック**: マウスホイールボタンをクリック

**スクロール**
- **スクロール**: 上下方向にスクロール（スクロール量指定可能）

#### キーボード操作（紫色）

- **キーを押す**: 指定したキーを押す（例: enter, tab, esc, ctrl+c）
- **テキストを入力**: 指定したテキストを入力

#### 制御（オレンジ色）

- **待機**: 指定した秒数待機
- **繰り返し**: 指定した回数繰り返し実行

#### 変数（赤色）

- **変数設定/取得**: 数値の保存・参照
- **数値**: 数値リテラル

### フェイルセーフ機能

**フェイルセーフとは**
- マウスが画面の四隅に移動すると自動的にプログラムを停止する安全機能

**設定方法**
- ヘッダーの「フェイルセーフ有効」チェックボックスで切り替え
- プログラムごとに個別設定が可能
- デフォルトは「有効」

**推奨設定**
- 初心者や不安定なプログラム: **有効**
- 画面端での操作が必要: **無効**

## 使用例

### 例1: 基本的なクリック操作
```
1. 「マウスを絶対座標に移動」ブロック
   - X: 100, Y: 200
2. 「左ボタン シングルクリック」ブロック
3. 「待機 1 秒」ブロック
```

### 例2: 繰り返し操作
```
1. 「繰り返し 5 回」ブロック
   内側に以下を配置:
   - 「マウスを絶対座標に移動」(X: 300, Y: 400)
   - 「左ボタン シングルクリック」
   - 「待機 2 秒」
```

### 例3: テキスト入力
```
1. 「マウスを絶対座標に移動」(テキストボックス位置)
2. 「左ボタン シングルクリック」
3. 「テキスト "Hello, World!" を入力」
4. 「キー enter を押す」
```

## 座標の取得方法

画面座標を調べる方法：

1. **AutoNexのマウス位置表示を利用**
   - 右側パネルに現在のマウス座標がリアルタイム表示されます

2. **座標取得ツールを使用**
   - Windows: スクリーンキャプチャツール
   - Mac: Digital Color Meter（アプリケーション > ユーティリティ）
   - 各種座標取得ツール

## トラブルシューティング

### よくある問題

**Q: プログラムが実行されない**
- サーバーが起動しているか確認
- ブラウザのコンソール（F12）でエラーをチェック
- フェイルセーフが作動していないか確認

**Q: マウス操作が期待した位置で動作しない**
- 座標が正確か確認（右側パネルのマウス位置表示を活用）
- 画面解像度が変わっていないか確認
- 他のウィンドウがマウス操作を妨げていないか確認

**Q: 読み込みエラーが発生する**
- 保存したプログラムファイルが破損していないか確認
- ブラウザのキャッシュをクリア
- saveディレクトリのアクセス権限を確認

**Q: プログラムが途中で止まる**
- フェイルセーフが作動した可能性（画面の角にマウスが移動）
- 例外エラーが発生（実行ログを確認）
- 存在しないウィンドウや要素をクリックしようとした

### 安全な使用のために

- **重要なファイルのバックアップ**: 自動操作前に重要なデータはバックアップ
- **テスト実行**: 本番実行前に安全な環境でテスト
- **フェイルセーフ**: 不安な場合はフェイルセーフを有効にして実行
- **停止方法の把握**: 「停止」ボタンの位置を事前に確認

## 技術仕様

- **フロントエンド**: HTML5, JavaScript, Blockly
- **バックエンド**: Python Flask
- **自動化ライブラリ**: PyAutoGUI
- **データ形式**: JSON（プログラム保存）

## ライセンス

このプロジェクトのライセンスについては、LICENSEファイルを参照してください。

## 貢献

バグ報告や機能提案は、GitHubのIssuesでお願いします。

## 更新履歴

### v1.0.0
- 初回リリース
- ビジュアルプログラミング環境
- 基本的なマウス・キーボード操作
- プログラム保存・読み込み機能
- フェイルセーフ機能